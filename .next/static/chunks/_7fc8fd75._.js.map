{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/app/domains/roles/RolesTable.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Modal from \"@/components/modal/Modal\";\r\nimport StatefulButton from \"@/components/ui/stateful-button\";\r\n\r\nconst inputCx =\r\n  \"mt-1 w-full rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100\";\r\n\r\nexport default function RoleFormDialog({\r\n  open,\r\n  onClose,\r\n  initial,          // { id?, name, labelTh, labelEn }\r\n  onSubmit,         // async (form) => {}\r\n  loading = false,  // สถานะบันทึก\r\n  error = \"\",       // ถ้าส่งมาก็จะแสดงบนฟอร์ม\r\n}) {\r\n  const [form, setForm] = useState({\r\n    id: null,\r\n    name: \"\",\r\n    labelTh: \"\",\r\n    labelEn: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    setForm({\r\n      id: initial?.id ?? null,\r\n      name: initial?.name ?? \"\",\r\n      labelTh: initial?.labelTh ?? \"\",\r\n      labelEn: initial?.labelEn ?? \"\",\r\n    });\r\n  }, [initial, open]);\r\n\r\n  const isEdit = !!form.id;\r\n\r\n  const footer = (\r\n    <div className=\"flex gap-2\">\r\n      <button\r\n        type=\"button\"\r\n        className=\"rounded-md border px-4 py-2 text-sm dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800 disabled:opacity-60\"\r\n        onClick={onClose}\r\n        disabled={loading}\r\n      >\r\n        ยกเลิก\r\n      </button>\r\n      <StatefulButton\r\n        loading={loading}\r\n        onClick={() => onSubmit(form)}\r\n        className=\"rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80 disabled:opacity-60\"\r\n      >\r\n        บันทึก\r\n      </StatefulButton>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Modal\r\n      open={open}\r\n      onClose={onClose}\r\n      title={isEdit ? `แก้ไข Role: ${initial?.name ?? \"\"}` : \"สร้าง Role ใหม่\"}\r\n      footer={footer}\r\n      size=\"md\"\r\n      dismissable={!loading}\r\n    >\r\n      <div className=\"space-y-4\">\r\n        {!!error && (\r\n          <div className=\"rounded-md border border-rose-200 bg-rose-50 dark:border-rose-900/40 dark:bg-rose-950/50 px-3 py-2 text-sm text-rose-700 dark:text-rose-300\">\r\n            {String(error)}\r\n          </div>\r\n        )}\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">name (unique)</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.name}\r\n            onChange={(e) => setForm((s) => ({ ...s, name: e.target.value }))}\r\n            placeholder=\"เช่น admin, user, hr.manager\"\r\n            disabled={isEdit} // ส่วนมากไม่ให้เปลี่ยน name ตอนแก้ไข\r\n          />\r\n        </label>\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">labelTh</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.labelTh}\r\n            onChange={(e) => setForm((s) => ({ ...s, labelTh: e.target.value }))}\r\n            placeholder=\"ชื่อภาษาไทย\"\r\n          />\r\n        </label>\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">labelEn</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.labelEn}\r\n            onChange={(e) => setForm((s) => ({ ...s, labelEn: e.target.value }))}\r\n            placeholder=\"English label\"\r\n          />\r\n        </label>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAKA,MAAM,UACJ;AAEa,SAAS,eAAe,KAOtC;QAPsC,EACrC,IAAI,EACJ,OAAO,EACP,OAAO,EACP,QAAQ,EACR,UAAU,KAAK,EACf,QAAQ,EAAE,EACX,GAPsC;;IAQrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;QAC/B,IAAI;QACJ,MAAM;QACN,SAAS;QACT,SAAS;IACX;IAEA,IAAA,0KAAS;oCAAC;gBAEF,aACE,eACG,kBACA;YAJX,QAAQ;gBACN,IAAI,CAAA,cAAA,oBAAA,8BAAA,QAAS,EAAE,cAAX,yBAAA,cAAe;gBACnB,MAAM,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB;gBACvB,SAAS,CAAA,mBAAA,oBAAA,8BAAA,QAAS,OAAO,cAAhB,8BAAA,mBAAoB;gBAC7B,SAAS,CAAA,mBAAA,oBAAA,8BAAA,QAAS,OAAO,cAAhB,8BAAA,mBAAoB;YAC/B;QACF;mCAAG;QAAC;QAAS;KAAK;IAElB,MAAM,SAAS,CAAC,CAAC,KAAK,EAAE;IAExB,MAAM,uBACJ,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,MAAK;gBACL,WAAU;gBACV,SAAS;gBACT,UAAU;0BACX;;;;;;0BAGD,6LAAC,qJAAc;gBACb,SAAS;gBACT,SAAS,IAAM,SAAS;gBACxB,WAAU;0BACX;;;;;;;;;;;;QAU8B;IAJnC,qBACE,6LAAC,2IAAK;QACJ,MAAM;QACN,SAAS;QACT,OAAO,SAAS,AAAC,eAAkC,OAApB,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB,MAAO;QACvD,QAAQ;QACR,MAAK;QACL,aAAa,CAAC;kBAEd,cAAA,6LAAC;YAAI,WAAU;;gBACZ,CAAC,CAAC,uBACD,6LAAC;oBAAI,WAAU;8BACZ,OAAO;;;;;;8BAIZ,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,IAAI;4BAChB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,MAAM,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAC/D,aAAY;4BACZ,UAAU;;;;;;;;;;;;8BAId,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,OAAO;4BACnB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,SAAS,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAClE,aAAY;;;;;;;;;;;;8BAIhB,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,OAAO;4BACnB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,SAAS,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAClE,aAAY;;;;;;;;;;;;;;;;;;;;;;;AAMxB;GA/FwB;KAAA","debugId":null}},
    {"offset": {"line": 206, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/app/domains/roles/RoleFormDialog.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Modal from \"@/components/modal/Modal\";\r\nimport StatefulButton from \"@/components/ui/stateful-button\";\r\n\r\nconst inputCx =\r\n  \"mt-1 w-full rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100\";\r\n\r\nexport default function RoleFormDialog({\r\n  open,\r\n  onClose,\r\n  initial,          // { id?, name, labelTh, labelEn }\r\n  onSubmit,         // async (form) => {}\r\n  loading = false,  // สถานะบันทึก\r\n  error = \"\",       // ถ้าส่งมาก็จะแสดงบนฟอร์ม\r\n}) {\r\n  const [form, setForm] = useState({\r\n    id: null,\r\n    name: \"\",\r\n    labelTh: \"\",\r\n    labelEn: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    setForm({\r\n      id: initial?.id ?? null,\r\n      name: initial?.name ?? \"\",\r\n      labelTh: initial?.labelTh ?? \"\",\r\n      labelEn: initial?.labelEn ?? \"\",\r\n    });\r\n  }, [initial, open]);\r\n\r\n  const isEdit = !!form.id;\r\n\r\n  const footer = (\r\n    <div className=\"flex gap-2\">\r\n      <button\r\n        type=\"button\"\r\n        className=\"rounded-md border px-4 py-2 text-sm dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800 disabled:opacity-60\"\r\n        onClick={onClose}\r\n        disabled={loading}\r\n      >\r\n        ยกเลิก\r\n      </button>\r\n      <StatefulButton\r\n        loading={loading}\r\n        onClick={() => onSubmit(form)}\r\n        className=\"rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80 disabled:opacity-60\"\r\n      >\r\n        บันทึก\r\n      </StatefulButton>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <Modal\r\n      open={open}\r\n      onClose={onClose}\r\n      title={isEdit ? `แก้ไข Role: ${initial?.name ?? \"\"}` : \"สร้าง Role ใหม่\"}\r\n      footer={footer}\r\n      size=\"md\"\r\n      dismissable={!loading}\r\n    >\r\n      <div className=\"space-y-4\">\r\n        {!!error && (\r\n          <div className=\"rounded-md border border-rose-200 bg-rose-50 dark:border-rose-900/40 dark:bg-rose-950/50 px-3 py-2 text-sm text-rose-700 dark:text-rose-300\">\r\n            {String(error)}\r\n          </div>\r\n        )}\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">name (unique)</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.name}\r\n            onChange={(e) => setForm((s) => ({ ...s, name: e.target.value }))}\r\n            placeholder=\"เช่น admin, user, hr.manager\"\r\n            disabled={isEdit} // ส่วนมากไม่ให้เปลี่ยน name ตอนแก้ไข\r\n          />\r\n        </label>\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">labelTh</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.labelTh}\r\n            onChange={(e) => setForm((s) => ({ ...s, labelTh: e.target.value }))}\r\n            placeholder=\"ชื่อภาษาไทย\"\r\n          />\r\n        </label>\r\n\r\n        <label className=\"block\">\r\n          <div className=\"text-sm\">labelEn</div>\r\n          <input\r\n            className={inputCx}\r\n            value={form.labelEn}\r\n            onChange={(e) => setForm((s) => ({ ...s, labelEn: e.target.value }))}\r\n            placeholder=\"English label\"\r\n          />\r\n        </label>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAKA,MAAM,UACJ;AAEa,SAAS,eAAe,KAOtC;QAPsC,EACrC,IAAI,EACJ,OAAO,EACP,OAAO,EACP,QAAQ,EACR,UAAU,KAAK,EACf,QAAQ,EAAE,EACX,GAPsC;;IAQrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;QAC/B,IAAI;QACJ,MAAM;QACN,SAAS;QACT,SAAS;IACX;IAEA,IAAA,0KAAS;oCAAC;gBAEF,aACE,eACG,kBACA;YAJX,QAAQ;gBACN,IAAI,CAAA,cAAA,oBAAA,8BAAA,QAAS,EAAE,cAAX,yBAAA,cAAe;gBACnB,MAAM,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB;gBACvB,SAAS,CAAA,mBAAA,oBAAA,8BAAA,QAAS,OAAO,cAAhB,8BAAA,mBAAoB;gBAC7B,SAAS,CAAA,mBAAA,oBAAA,8BAAA,QAAS,OAAO,cAAhB,8BAAA,mBAAoB;YAC/B;QACF;mCAAG;QAAC;QAAS;KAAK;IAElB,MAAM,SAAS,CAAC,CAAC,KAAK,EAAE;IAExB,MAAM,uBACJ,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,MAAK;gBACL,WAAU;gBACV,SAAS;gBACT,UAAU;0BACX;;;;;;0BAGD,6LAAC,qJAAc;gBACb,SAAS;gBACT,SAAS,IAAM,SAAS;gBACxB,WAAU;0BACX;;;;;;;;;;;;QAU8B;IAJnC,qBACE,6LAAC,2IAAK;QACJ,MAAM;QACN,SAAS;QACT,OAAO,SAAS,AAAC,eAAkC,OAApB,CAAA,gBAAA,oBAAA,8BAAA,QAAS,IAAI,cAAb,2BAAA,gBAAiB,MAAO;QACvD,QAAQ;QACR,MAAK;QACL,aAAa,CAAC;kBAEd,cAAA,6LAAC;YAAI,WAAU;;gBACZ,CAAC,CAAC,uBACD,6LAAC;oBAAI,WAAU;8BACZ,OAAO;;;;;;8BAIZ,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,IAAI;4BAChB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,MAAM,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAC/D,aAAY;4BACZ,UAAU;;;;;;;;;;;;8BAId,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,OAAO;4BACnB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,SAAS,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAClE,aAAY;;;;;;;;;;;;8BAIhB,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAI,WAAU;sCAAU;;;;;;sCACzB,6LAAC;4BACC,WAAW;4BACX,OAAO,KAAK,OAAO;4BACnB,UAAU,CAAC,IAAM,QAAQ,CAAC,IAAM,CAAC;wCAAE,GAAG,CAAC;wCAAE,SAAS,EAAE,MAAM,CAAC,KAAK;oCAAC,CAAC;4BAClE,aAAY;;;;;;;;;;;;;;;;;;;;;;;AAMxB;GA/FwB;KAAA","debugId":null}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/components/modal/NoticeDialog.jsx"],"sourcesContent":["\"use client\";\r\nimport Modal from \"@/components/modal/Modal\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport React from \"react\";\r\n\r\nconst tone = {\r\n  success: {\r\n    ring: \"ring-green-200 dark:ring-green-900/40\",\r\n    bg: \"bg-green-50 dark:bg-green-900/30\",\r\n    text: \"text-green-800 dark:text-green-100\",\r\n    title: \"สำเร็จ\",\r\n  },\r\n  error: {\r\n    ring: \"ring-red-200 dark:ring-red-900/40\",\r\n    bg: \"bg-red-50 dark:bg-red-900/30\",\r\n    text: \"text-red-800 dark:text-red-100\",\r\n    title: \"เกิดข้อผิดพลาด\",\r\n  },\r\n  info: {\r\n    ring: \"ring-blue-200 dark:ring-blue-900/40\",\r\n    bg: \"bg-blue-50 dark:bg-blue-900/30\",\r\n    text: \"text-blue-800 dark:text-blue-100\",\r\n    title: \"แจ้งเตือน\",\r\n  },\r\n};\r\n\r\nfunction normalizeMessage(msg) {\r\n  // 1) ปล่อย ReactNode ผ่านไปได้เลย\r\n  if (React.isValidElement(msg)) return msg;\r\n\r\n  // 2) string → คืนตรงๆ\r\n  if (typeof msg === \"string\") return msg;\r\n\r\n  // 3) Error instance\r\n  if (msg instanceof Error) return msg.message || \"Unexpected error\";\r\n\r\n  // 4) รูปแบบที่พบบ่อยจาก backend\r\n  const fromCommonShape =\r\n    msg?.message ||\r\n    msg?.error ||\r\n    msg?.data?.message ||\r\n    msg?.data?.error;\r\n\r\n  if (typeof fromCommonShape === \"string\") return fromCommonShape;\r\n\r\n  // 5) fallback: stringify แบบสั้นๆ\r\n  try {\r\n    return JSON.stringify(msg);\r\n  } catch {\r\n    return \"Unknown error\";\r\n  }\r\n}\r\n\r\nexport default function NoticeDialog({\r\n  open,\r\n  onClose,\r\n  type = \"info\", // 'success' | 'error' | 'info'\r\n  title,\r\n  message,\r\n  footerButtons, // optional: <Button>...</Button>\r\n}) {\r\n  const t = tone[type] || tone.info;\r\n  const content = normalizeMessage(message);\r\n\r\n  return (\r\n    <Modal\r\n      open={open}\r\n      onClose={onClose}\r\n      size=\"md\"\r\n      title={title || t.title}\r\n      footer={footerButtons ?? <Button onClick={onClose}>ปิด</Button>}\r\n    >\r\n      <div className={`rounded-md ${t.bg} ${t.ring} p-3`} role=\"status\" aria-live=\"polite\">\r\n        {/* ถ้า content เป็น ReactNode ก็ render ตรง ๆ ได้ */}\r\n        {typeof content === \"string\" ? (\r\n          <p className={`text-sm ${t.text}`}>{content}</p>\r\n        ) : (\r\n          <div className={`text-sm ${t.text}`}>{content}</div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKA,MAAM,OAAO;IACX,SAAS;QACP,MAAM;QACN,IAAI;QACJ,MAAM;QACN,OAAO;IACT;IACA,OAAO;QACL,MAAM;QACN,IAAI;QACJ,MAAM;QACN,OAAO;IACT;IACA,MAAM;QACJ,MAAM;QACN,IAAI;QACJ,MAAM;QACN,OAAO;IACT;AACF;AAEA,SAAS,iBAAiB,GAAG;QAczB,WACA;IAdF,kCAAkC;IAClC,kBAAI,wKAAK,CAAC,cAAc,CAAC,MAAM,OAAO;IAEtC,sBAAsB;IACtB,IAAI,OAAO,QAAQ,UAAU,OAAO;IAEpC,oBAAoB;IACpB,IAAI,eAAe,OAAO,OAAO,IAAI,OAAO,IAAI;IAEhD,gCAAgC;IAChC,MAAM,kBACJ,CAAA,gBAAA,0BAAA,IAAK,OAAO,MACZ,gBAAA,0BAAA,IAAK,KAAK,MACV,gBAAA,2BAAA,YAAA,IAAK,IAAI,cAAT,gCAAA,UAAW,OAAO,MAClB,gBAAA,2BAAA,aAAA,IAAK,IAAI,cAAT,iCAAA,WAAW,KAAK;IAElB,IAAI,OAAO,oBAAoB,UAAU,OAAO;IAEhD,kCAAkC;IAClC,IAAI;QACF,OAAO,KAAK,SAAS,CAAC;IACxB,EAAE,UAAM;QACN,OAAO;IACT;AACF;AAEe,SAAS,aAAa,KAOpC;QAPoC,EACnC,IAAI,EACJ,OAAO,EACP,OAAO,MAAM,EACb,KAAK,EACL,OAAO,EACP,aAAa,EACd,GAPoC;IAQnC,MAAM,IAAI,IAAI,CAAC,KAAK,IAAI,KAAK,IAAI;IACjC,MAAM,UAAU,iBAAiB;IAEjC,qBACE,6LAAC,2IAAK;QACJ,MAAM;QACN,SAAS;QACT,MAAK;QACL,OAAO,SAAS,EAAE,KAAK;QACvB,QAAQ,0BAAA,2BAAA,8BAAiB,6LAAC,wIAAM;YAAC,SAAS;sBAAS;;;;;;kBAEnD,cAAA,6LAAC;YAAI,WAAW,AAAC,cAAqB,OAAR,EAAE,EAAE,EAAC,KAAU,OAAP,EAAE,IAAI,EAAC;YAAO,MAAK;YAAS,aAAU;sBAEzE,OAAO,YAAY,yBAClB,6LAAC;gBAAE,WAAW,AAAC,WAAiB,OAAP,EAAE,IAAI;0BAAK;;;;;qCAEpC,6LAAC;gBAAI,WAAW,AAAC,WAAiB,OAAP,EAAE,IAAI;0BAAK;;;;;;;;;;;;;;;;AAKhD;KA7BwB","debugId":null}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/lib/api/roles.js"],"sourcesContent":["import { apiFetch } from \"@/lib/api\";\r\n\r\n// ช่วยแปลงผลลัพธ์ให้รองรับทั้ง {ok,data} หรือ array ตรง ๆ\r\nfunction unwrapList(res) {\r\n  if (!res) return [];\r\n  if (Array.isArray(res)) return res;\r\n  if (Array.isArray(res?.data)) return res.data;\r\n  return [];\r\n}\r\n\r\n/** GET /api/roles?q=&page=&limit=&sortBy=&sort= */\r\nexport async function listRoles(params = {}) {\r\n  const search = new URLSearchParams({\r\n    q: params.q ?? \"\",\r\n    page: String(params.page ?? 1),\r\n    limit: String(params.limit ?? 200),\r\n    sortBy: params.sortBy ?? \"id\",\r\n    sort: params.sort ?? \"asc\",\r\n  });\r\n  const res = await apiFetch(`/api/roles?${search.toString()}`);\r\n  return unwrapList(res);\r\n}\r\n\r\n/** POST /api/roles  body: {name, labelTh?, labelEn?} */\r\nexport async function createRole(payload) {\r\n  return apiFetch(`/api/roles`, { method: \"POST\", body: payload });\r\n}\r\n\r\n/** PUT /api/roles/:id  body: {labelTh?, labelEn?} */\r\nexport async function updateRole(id, payload) {\r\n  if (!id) throw new Error(\"Missing role id\");\r\n  return apiFetch(`/api/roles/${id}`, { method: \"PUT\", body: payload });\r\n}\r\n\r\n/** DELETE /api/roles/:id */\r\nexport async function deleteRole(id) {\r\n  if (!id) throw new Error(\"Missing role id\");\r\n  return apiFetch(`/api/roles/${id}`, { method: \"DELETE\" });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,0DAA0D;AAC1D,SAAS,WAAW,GAAG;IACrB,IAAI,CAAC,KAAK,OAAO,EAAE;IACnB,IAAI,MAAM,OAAO,CAAC,MAAM,OAAO;IAC/B,IAAI,MAAM,OAAO,CAAC,gBAAA,0BAAA,IAAK,IAAI,GAAG,OAAO,IAAI,IAAI;IAC7C,OAAO,EAAE;AACX;AAGO,eAAe;QAAU,SAAA,iEAAS,CAAC;QAEnC,WACU,cACC,eACN,gBACF;IALR,MAAM,SAAS,IAAI,gBAAgB;QACjC,GAAG,CAAA,YAAA,OAAO,CAAC,cAAR,uBAAA,YAAY;QACf,MAAM,OAAO,CAAA,eAAA,OAAO,IAAI,cAAX,0BAAA,eAAe;QAC5B,OAAO,OAAO,CAAA,gBAAA,OAAO,KAAK,cAAZ,2BAAA,gBAAgB;QAC9B,QAAQ,CAAA,iBAAA,OAAO,MAAM,cAAb,4BAAA,iBAAiB;QACzB,MAAM,CAAA,eAAA,OAAO,IAAI,cAAX,0BAAA,eAAe;IACvB;IACA,MAAM,MAAM,MAAM,IAAA,yHAAQ,EAAC,AAAC,cAA+B,OAAlB,OAAO,QAAQ;IACxD,OAAO,WAAW;AACpB;AAGO,eAAe,WAAW,OAAO;IACtC,OAAO,IAAA,yHAAQ,EAAE,cAAa;QAAE,QAAQ;QAAQ,MAAM;IAAQ;AAChE;AAGO,eAAe,WAAW,EAAE,EAAE,OAAO;IAC1C,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;IACzB,OAAO,IAAA,yHAAQ,EAAC,AAAC,cAAgB,OAAH,KAAM;QAAE,QAAQ;QAAO,MAAM;IAAQ;AACrE;AAGO,eAAe,WAAW,EAAE;IACjC,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;IACzB,OAAO,IAAA,yHAAQ,EAAC,AAAC,cAAgB,OAAH,KAAM;QAAE,QAAQ;IAAS;AACzD","debugId":null}},
    {"offset": {"line": 574, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/app/admin/roles/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport RolesTable from \"@/app/domains/roles/RolesTable\";\r\nimport RoleFormDialog from \"@/app/domains/roles/RoleFormDialog\";\r\nimport ConfirmDialog from \"@/components/modal/ConfirmDialog\";\r\nimport NoticeDialog from \"@/components/modal/NoticeDialog\";\r\nimport { listRoles, createRole, updateRole, deleteRole } from \"@/lib/api/roles\";\r\n\r\nexport default function AdminRolesPage() {\r\n  const [q, setQ] = useState(\"\");\r\n  const [rows, setRows] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  // ฟอร์ม\r\n  const [dlgOpen, setDlgOpen] = useState(false);\r\n  const [editing, setEditing] = useState(null);\r\n  const [saving, setSaving] = useState(false);\r\n  const [formError, setFormError] = useState(\"\");\r\n\r\n  // ลบ\r\n  const [confirm, setConfirm] = useState({ open: false, row: null, loading: false, error: \"\" });\r\n\r\n  // แจ้งผล\r\n  const [notice, setNotice] = useState({ open: false, type: \"success\", message: \"\" });\r\n\r\n  const debouncedQ = useDebounce(q, 300);\r\n\r\n  async function load() {\r\n    setLoading(true);\r\n    try {\r\n      const items = await listRoles({ q: debouncedQ, page: 1, limit: 200, sortBy: \"id\", sort: \"asc\" });\r\n      setRows(items);\r\n      setError(\"\");\r\n    } catch (e) {\r\n      setError(e?.data?.message || e?.message || \"โหลดไม่สำเร็จ\");\r\n      setRows([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    load();\r\n  }, [debouncedQ]);\r\n\r\n  // ——— Actions ———\r\n  function openNew() {\r\n    setEditing(null);\r\n    setFormError(\"\");\r\n    setDlgOpen(true);\r\n  }\r\n  function openEdit(row) {\r\n    setEditing({ id: row.id, name: row.name, labelTh: row.labelTh, labelEn: row.labelEn });\r\n    setFormError(\"\");\r\n    setDlgOpen(true);\r\n  }\r\n\r\n  async function handleSubmit(form) {\r\n    try {\r\n      setSaving(true);\r\n      setFormError(\"\");\r\n      if (form.id) {\r\n        await updateRole(form.id, {\r\n          labelTh: form.labelTh || null,\r\n          labelEn: form.labelEn || null,\r\n        });\r\n        setNotice({ open: true, type: \"success\", message: `อัปเดต ${form.name} สำเร็จ` });\r\n      } else {\r\n        await createRole({\r\n          name: form.name,\r\n          labelTh: form.labelTh || null,\r\n          labelEn: form.labelEn || null,\r\n        });\r\n        setNotice({ open: true, type: \"success\", message: `สร้าง ${form.name} สำเร็จ` });\r\n      }\r\n      setDlgOpen(false);\r\n      await load();\r\n    } catch (e) {\r\n      setFormError(e?.data?.message || e.message || \"บันทึกไม่สำเร็จ\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  function askDelete(row) {\r\n    setConfirm({ open: true, row, loading: false, error: \"\" });\r\n  }\r\n  async function onConfirmDelete() {\r\n    setConfirm((s) => ({ ...s, loading: true, error: \"\" }));\r\n    try {\r\n      await deleteRole(confirm.row.id);\r\n      setConfirm({ open: false, row: null, loading: false, error: \"\" });\r\n      setNotice({ open: true, type: \"success\", message: `ลบ ${confirm.row.name} สำเร็จ` });\r\n      await load();\r\n    } catch (e) {\r\n      setConfirm((s) => ({ ...s, loading: false, error: e?.data?.message || e.message || \"ลบไม่สำเร็จ\" }));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <main className=\"pt-20 px-4 sm:px-6 lg:px-8 max-w-screen-xl mx-auto space-y-4\">\r\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n        <h1 className=\"text-xl sm:text-2xl font-semibold text-neutral-800 dark:text-neutral-100\">Roles</h1>\r\n        <div className=\"flex flex-wrap gap-3 items-center\">\r\n          <input\r\n            className=\"w-52 rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-200\"\r\n            placeholder=\"ค้นหา role\"\r\n            value={q}\r\n            onChange={(e) => setQ(e.target.value)}\r\n          />\r\n          <button\r\n            className=\"hidden sm:inline-flex items-center rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80\"\r\n            onClick={openNew}\r\n          >\r\n            + สร้างใหม่\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      <RolesTable\r\n        items={rows}\r\n        loading={loading}\r\n        error={error}\r\n        onEdit={openEdit}\r\n        onDelete={askDelete}\r\n      />\r\n\r\n      {/* FAB (mobile) */}\r\n      <button\r\n        onClick={openNew}\r\n        className=\"sm:hidden fixed bottom-5 right-5 z-40 rounded-full h-12 w-12 shadow-lg bg-black text-white dark:bg-white dark:text-black flex items-center justify-center text-xl leading-none\"\r\n        aria-label=\"สร้างใหม่\"\r\n      >\r\n        +\r\n      </button>\r\n\r\n      <RoleFormDialog\r\n        open={dlgOpen}\r\n        onClose={() => setDlgOpen(false)}\r\n        initial={editing}\r\n        onSubmit={handleSubmit}\r\n        loading={saving}\r\n        error={formError}\r\n      />\r\n\r\n      <ConfirmDialog\r\n        open={confirm.open}\r\n        title=\"ยืนยันการลบ\"\r\n        description={confirm.row ? `ต้องการลบ role \"${confirm.row.name}\" ใช่ไหม?` : \"\"}\r\n        loading={confirm.loading}\r\n        error={confirm.error}\r\n        onCancel={() => setConfirm({ open: false, row: null, loading: false, error: \"\" })}\r\n        onConfirm={onConfirmDelete}\r\n      />\r\n\r\n      <NoticeDialog\r\n        open={notice.open}\r\n        type={notice.type}\r\n        message={notice.message}\r\n        onClose={() => setNotice({ open: false, type: \"success\", message: \"\" })}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n\r\n// ——— utils: debounce hook ———\r\nfunction useDebounce(value, delay = 300) {\r\n  const [v, setV] = useState(value);\r\n  useEffect(() => {\r\n    const t = setTimeout(() => setV(value), delay);\r\n    return () => clearTimeout(t);\r\n  }, [value, delay]);\r\n  return v;\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}