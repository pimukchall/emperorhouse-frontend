{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/app/%28app%29/admin/organizations/page.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { apiFetch } from \"@/lib/api\";\r\n\r\nfunction Dialog({ open, onClose, title, children, footer }) {\r\n  if (!open) return null;\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\" onClick={onClose}>\r\n      <div className=\"w-[620px] max-w-[95vw] rounded-lg bg-white dark:bg-neutral-900 shadow-2xl p-6\" onClick={(e)=>e.stopPropagation()}>\r\n        <h2 className=\"mb-4 text-lg font-semibold text-neutral-800 dark:text-neutral-100\">{title}</h2>\r\n        <div className=\"space-y-3\">{children}</div>\r\n        <div className=\"mt-6 flex justify-end gap-2\">{footer}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction GhostButton({ children, className = \"\", ...rest }) {\r\n  return (\r\n    <button className={`px-2 py-1 rounded-md border dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800 disabled:opacity-50 ${className}`} {...rest}>\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\nconst cx = \"mt-1 w-full rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100\";\r\n\r\nexport default function AdminOrganizationsPage() {\r\n  const [items, setItems] = useState([]);\r\n  const [q, setQ] = useState(\"\");\r\n  const [includeDeleted, setIncludeDeleted] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [editing, setEditing] = useState({ id: 0, code: \"\", nameTh: \"\", nameEn: \"\" });\r\n\r\n  async function load() {\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiFetch(\r\n        `/api/organizations?page=1&limit=50&q=${encodeURIComponent(q)}&includeDeleted=${includeDeleted ? \"1\" : \"0\"}&sortBy=id&sort=asc`\r\n      );\r\n      setItems(res?.data || []);\r\n      setError(\"\");\r\n    } catch (e) {\r\n      setError(e?.data?.error || e?.message || \"โหลดไม่สำเร็จ\");\r\n      setItems([]);\r\n    } finally { setLoading(false); }\r\n  }\r\n  useEffect(() => { load(); }, [q, includeDeleted]);\r\n\r\n  function openNew() { setEditing({ id: 0, code: \"\", nameTh: \"\", nameEn: \"\" }); setDialogOpen(true); }\r\n  function openEdit(o) { setEditing({ id: o.id, code: o.code || \"\", nameTh: o.nameTh || \"\", nameEn: o.nameEn || \"\" }); setDialogOpen(true); }\r\n\r\n  async function save() {\r\n    const payload = { code: editing.code || null, nameTh: editing.nameTh || null, nameEn: editing.nameEn || null };\r\n    if (editing.id === 0) await apiFetch(`/api/organizations`, { method: \"POST\", body: payload });\r\n    else await apiFetch(`/api/organizations/${editing.id}`, { method: \"PUT\", body: payload });\r\n    setDialogOpen(false); load();\r\n  }\r\n  async function softDelete(id) { await apiFetch(`/api/organizations/${id}`, { method: \"DELETE\" }); load(); }\r\n  async function restore(id) { await apiFetch(`/api/organizations/${id}/restore`, { method: \"POST\" }); load(); }\r\n  async function destroy(id) { if (!confirm(\"ลบถาวร?\")) return; await apiFetch(`/api/organizations/${id}?hard=1`, { method: \"DELETE\" }); load(); }\r\n\r\n  return (\r\n    <main className=\"pt-20 px-4 sm:px-6 lg:px-8 max-w-screen-xl mx-auto space-y-4\">\r\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n        <h1 className=\"text-xl sm:text-2xl font-semibold text-neutral-800 dark:text-neutral-100\">Organizations</h1>\r\n        <div className=\"flex flex-wrap gap-3 items-center\">\r\n          <input className=\"w-52 rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-200\" placeholder=\"ค้นหา code / ชื่อ\" value={q} onChange={(e)=>setQ(e.target.value)} />\r\n          <label className=\"flex items-center gap-2 text-sm\">\r\n            <input type=\"checkbox\" checked={includeDeleted} onChange={(e)=>setIncludeDeleted(e.target.checked)} /> แสดงที่ลบแล้ว\r\n          </label>\r\n          <button className=\"hidden sm:inline-flex items-center rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80\" onClick={openNew}>\r\n            + สร้างใหม่\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      <section className=\"rounded-xl border dark:border-neutral-700 overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-neutral-100 dark:bg-neutral-800\">\r\n              <tr><Th>ID</Th><Th>Code</Th><Th>Name (TH)</Th><Th>Name (EN)</Th><Th>Deleted?</Th><Th right>Actions</Th></tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><Td colSpan={6} className=\"text-center p-6\">Loading…</Td></tr>\r\n              ) : items.length === 0 ? (\r\n                <tr><Td colSpan={6} className=\"text-center p-6\">ไม่พบข้อมูล</Td></tr>\r\n              ) : (\r\n                items.map((o, idx) => (\r\n                  <tr key={o.id} className={`border-t dark:border-neutral-700 ${idx%2===0 ? \"bg-neutral-50 dark:bg-neutral-900/50\":\"\"} hover:bg-neutral-100 dark:hover:bg-neutral-800`}>\r\n                    <Td>{o.id}</Td>\r\n                    <Td className=\"font-mono\">{o.code}</Td>\r\n                    <Td>{o.nameTh}</Td>\r\n                    <Td>{o.nameEn}</Td>\r\n                    <Td>{o.deletedAt ? \"Yes\" : \"-\"}</Td>\r\n                    <Td right>\r\n                      <div className=\"flex flex-wrap gap-1 justify-end\">\r\n                        <GhostButton onClick={()=>openEdit(o)}>Edit</GhostButton>\r\n                        {!o.deletedAt ? (\r\n                          <GhostButton className=\"text-amber-600\" onClick={()=>softDelete(o.id)}>Delete</GhostButton>\r\n                        ) : (\r\n                          <>\r\n                            <GhostButton className=\"text-green-600\" onClick={()=>restore(o.id)}>Restore</GhostButton>\r\n                            <GhostButton className=\"text-rose-600\" onClick={()=>destroy(o.id)}>Destroy</GhostButton>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </Td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </section>\r\n\r\n      {/* FAB (mobile) */}\r\n      <button onClick={openNew} className=\"sm:hidden fixed bottom-5 right-5 z-40 rounded-full h-12 w-12 shadow-lg bg-black text-white dark:bg-white dark:text-black flex items-center justify-center text-xl leading-none\" aria-label=\"สร้างใหม่\">+</button>\r\n\r\n      {/* Dialog */}\r\n      <Dialog\r\n        open={dialogOpen}\r\n        onClose={()=>setDialogOpen(false)}\r\n        title={editing.id ? `แก้ไข #${editing.id}` : \"สร้างใหม่\"}\r\n        footer={\r\n          <>\r\n            <button className=\"rounded-md border px-4 py-2 text-sm dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800\" onClick={()=>setDialogOpen(false)}>ยกเลิก</button>\r\n            <button className=\"rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80\" onClick={save}>บันทึก</button>\r\n          </>\r\n        }\r\n      >\r\n        <label className=\"block\"><div className=\"text-sm\">Code</div><input className={cx} value={editing.code} onChange={(e)=>setEditing(s=>({...s, code:e.target.value}))} /></label>\r\n        <label className=\"block\"><div className=\"text-sm\">Name (TH)</div><input className={cx} value={editing.nameTh} onChange={(e)=>setEditing(s=>({...s, nameTh:e.target.value}))} /></label>\r\n        <label className=\"block\"><div className=\"text-sm\">Name (EN)</div><input className={cx} value={editing.nameEn} onChange={(e)=>setEditing(s=>({...s, nameEn:e.target.value}))} /></label>\r\n      </Dialog>\r\n\r\n      {!!error && <div className=\"text-red-500 text-sm\">{error}</div>}\r\n    </main>\r\n  );\r\n}\r\nfunction Th({ children, right }) { return <th className={`px-3 py-2 ${right?\"text-right\":\"text-left\"} text-neutral-700 dark:text-neutral-200`}>{children}</th>; }\r\nfunction Td({ children, right, ...rest }) { return <td className={`px-3 py-2 ${right?\"text-right\":\"\"}`} {...rest}>{children}</td>; }\r\n"],"names":[],"mappings":"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","debugId":null}}]
}