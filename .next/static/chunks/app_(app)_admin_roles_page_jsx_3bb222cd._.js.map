{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Workspace/emperorhouse-frontend/app/%28app%29/admin/roles/page.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { apiFetch } from \"@/lib/api\";\r\n\r\nfunction Dialog({ open, onClose, title, children, footer }) {\r\n  if (!open) return null;\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\" onClick={onClose}>\r\n      <div className=\"w-[620px] max-w-[95vw] rounded-lg bg-white dark:bg-neutral-900 shadow-2xl p-6\" onClick={(e)=>e.stopPropagation()}>\r\n        <h2 className=\"mb-4 text-lg font-semibold text-neutral-800 dark:text-neutral-100\">{title}</h2>\r\n        <div className=\"space-y-3\">{children}</div>\r\n        <div className=\"mt-6 flex justify-end gap-2\">{footer}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nfunction GhostButton({ children, className = \"\", ...rest }) {\r\n  return (\r\n    <button className={`px-2 py-1 rounded-md border dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800 disabled:opacity-50 ${className}`} {...rest}>\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\nconst cx = \"mt-1 w-full rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100\";\r\n\r\nexport default function AdminRolesPage() {\r\n  const [items, setItems] = useState([]);\r\n  const [q, setQ] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [editing, setEditing] = useState({ name: \"\", labelTh: \"\", labelEn: \"\" });\r\n\r\n  async function load() {\r\n    setLoading(true);\r\n    try {\r\n      const res = await apiFetch(`/api/roles?q=${encodeURIComponent(q)}&page=1&limit=200&sortBy=id&sort=asc`);\r\n      setItems(res?.data || []);\r\n      setError(\"\");\r\n    } catch (e) {\r\n      setError(e?.data?.error || e?.message || \"โหลดไม่สำเร็จ\");\r\n      setItems([]);\r\n    } finally { setLoading(false); }\r\n  }\r\n  useEffect(() => { load(); }, [q]);\r\n\r\n  function openNew() { setEditing({ name: \"\", labelTh: \"\", labelEn: \"\" }); setDialogOpen(true); }\r\n  function openEdit(r) { setEditing({ name: r.name || \"\", labelTh: r.labelTh || \"\", labelEn: r.labelEn || \"\" }); setDialogOpen(true); }\r\n\r\n  async function save() {\r\n    if (!editing.name) return;\r\n    await apiFetch(`/api/roles`, { method: \"POST\", body: { name: editing.name, labelTh: editing.labelTh || null, labelEn: editing.labelEn || null } });\r\n    setDialogOpen(false); load();\r\n  }\r\n  async function remove(name) { if (!confirm(`ลบ role \"${name}\" ?`)) return; await apiFetch(`/api/roles/${encodeURIComponent(name)}`, { method: \"DELETE\" }); load(); }\r\n\r\n  return (\r\n    <main className=\"pt-20 px-4 sm:px-6 lg:px-8 max-w-screen-xl mx-auto space-y-4\">\r\n      <header className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n        <h1 className=\"text-xl sm:text-2xl font-semibold text-neutral-800 dark:text-neutral-100\">Roles</h1>\r\n        <div className=\"flex flex-wrap gap-3 items-center\">\r\n          <input className=\"w-52 rounded-md border px-3 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-200\" placeholder=\"ค้นหา role\" value={q} onChange={(e)=>setQ(e.target.value)} />\r\n          <button className=\"hidden sm:inline-flex items-center rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80\" onClick={openNew}>+ สร้างใหม่</button>\r\n        </div>\r\n      </header>\r\n\r\n      <section className=\"rounded-xl border dark:border-neutral-700 overflow-hidden\">\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-neutral-100 dark:bg-neutral-800\">\r\n              <tr><Th>ID</Th><Th>name</Th><Th>labelTh</Th><Th>labelEn</Th><Th right>Actions</Th></tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><Td colSpan={5} className=\"text-center p-6\">Loading…</Td></tr>\r\n              ) : items.length === 0 ? (\r\n                <tr><Td colSpan={5} className=\"text-center p-6\">ไม่พบข้อมูล</Td></tr>\r\n              ) : (\r\n                items.map((r, idx) => (\r\n                  <tr key={r.id ?? r.name} className={`border-t dark:border-neutral-700 ${idx%2===0 ? \"bg-neutral-50 dark:bg-neutral-900/50\":\"\"} hover:bg-neutral-100 dark:hover:bg-neutral-800`}>\r\n                    <Td>{r.id}</Td>\r\n                    <Td className=\"font-mono\">{r.name}</Td>\r\n                    <Td>{r.labelTh || \"-\"}</Td>\r\n                    <Td>{r.labelEn || \"-\"}</Td>\r\n                    <Td right>\r\n                      <div className=\"flex gap-1 justify-end\">\r\n                        <GhostButton onClick={()=>openEdit(r)}>Edit</GhostButton>\r\n                        <GhostButton className=\"text-rose-600\" onClick={()=>remove(r.name)}>Delete</GhostButton>\r\n                      </div>\r\n                    </Td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </section>\r\n\r\n      {/* FAB (mobile) */}\r\n      <button onClick={openNew} className=\"sm:hidden fixed bottom-5 right-5 z-40 rounded-full h-12 w-12 shadow-lg bg-black text-white dark:bg-white dark:text-black flex items-center justify-center text-xl leading-none\" aria-label=\"สร้างใหม่\">+</button>\r\n\r\n      {/* Dialog */}\r\n      <Dialog\r\n        open={dialogOpen}\r\n        onClose={()=>setDialogOpen(false)}\r\n        title={editing?.name ? `แก้ไข ${editing.name}` : \"สร้างใหม่\"}\r\n        footer={\r\n          <>\r\n            <button className=\"rounded-md border px-4 py-2 text-sm dark:border-neutral-700 hover:bg-neutral-50 dark:hover:bg-neutral-800\" onClick={()=>setDialogOpen(false)}>ยกเลิก</button>\r\n            <button className=\"rounded-md bg-black text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-medium hover:opacity-80\" onClick={save}>บันทึก</button>\r\n          </>\r\n        }\r\n      >\r\n        <label className=\"block\"><div className=\"text-sm\">name (unique)</div><input className={cx} value={editing.name} onChange={(e)=>setEditing(s=>({...s, name:e.target.value}))} placeholder=\"เช่น admin, user, hr.manager\" /></label>\r\n        <label className=\"block\"><div className=\"text-sm\">labelTh</div><input className={cx} value={editing.labelTh} onChange={(e)=>setEditing(s=>({...s, labelTh:e.target.value}))} placeholder=\"ชื่อภาษาไทย\" /></label>\r\n        <label className=\"block\"><div className=\"text-sm\">labelEn</div><input className={cx} value={editing.labelEn} onChange={(e)=>setEditing(s=>({...s, labelEn:e.target.value}))} placeholder=\"English label\" /></label>\r\n      </Dialog>\r\n\r\n      {!!error && <div className=\"text-red-500 text-sm\">{error}</div>}\r\n    </main>\r\n  );\r\n}\r\nfunction Th({ children, right }) { return <th className={`px-3 py-2 ${right?\"text-right\":\"text-left\"} text-neutral-700 dark:text-neutral-200`}>{children}</th>; }\r\nfunction Td({ children, right, ...rest }) { return <td className={`px-3 py-2 ${right?\"text-right\":\"\"}`} {...rest}>{children}</td>; }\r\n"],"names":[],"mappings":"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","debugId":null}}]
}